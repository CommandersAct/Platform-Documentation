# Google Universal Analytics

[Google ](https://about.google/)is a multinational technology company focusing on online advertising, search engine technology, cloud computing, and computer software.\
Google Universal Analytics (UA) is a web analytics service that tracks and reports website traffic. Using this destination, you can take advantage of the [Measurement Protocol](https://developers.google.com/analytics/devguides/collection/protocol/v1) by sending data via server-side. This version is related to the previous generation of Google Analytics. \
See [Google Analytics 4](google-analytics-4/) destination for the newest and recommended version.

{% hint style="warning" %}
Google Universal Analytics will be deprecated on **July 1, 2023**, meaning it will stop processing data. Analytics 360 properties will stop working on **October 1, 2023**.
{% endhint %}

## Key features

The Google Universal Analytics destination provides the following key features:

* **Events structure**: our [Events reference](https://community.commandersact.com/platform-x/developers/tracking/events-reference) model covers [Google's hit types](https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#t), meaning that your data is properly bridged to the expected fields in an optimized way.
* **Prebuilt mappings**: data mapping for event-based destinations happens automatically, which simplifies user inputs.
* **Smart mapping**: data mapping can be readjusted using your datalayer defined fields.&#x20;
* **Refined data**: you can freely push additional information based on your specific needs (E.g. adding custom events and custom properties).
* **Support for multi-item data**: information included in the [item](https://community.commandersact.com/platform-x/developers/tracking/events-reference#item) array is dispatched to UA.

## Destination setup

### Configuration

<table><thead><tr><th width="307">Settings</th><th>Description</th></tr></thead><tbody><tr><td><code>Tracking ID</code></td><td><p><em><strong><code>Required</code></strong></em></p><p>The tracking identifier is a string like "UA-XXXXXX-Y". It must be included in your tracking code to tell Analytics which account and property to send data to.</p></td></tr><tr><td><code>Custom Event Properties</code></td><td>Map your custom event properties by setting their field names in <code>Event property name</code> and adding the field name holding the value in <code>Commanders Act event property or static value</code>. E.g. if you input<code>size</code>in the <code>Event property name</code> and<code>properties.items.0.product.size</code> <strong>[1]</strong> in <code>Commanders Act event property or static value</code>, you will have a custom event property in GA4 called<code>size</code>with a value based on the content of the field<code>properties.items.0.product.size</code>. You also have the option to set a static string/numeric value in <code>Commanders Act event property or static value</code>.<br><br>In the column <code>Commanders Act event property position</code> you should keep the value <code>Default</code> as it better fits most scenarios. E.g. this can be used to set <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#customs">Custom Dimensions and Metrics</a> and/or <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#cg_">Content Groups</a>. In case you select either <code>In "Item List" (E.g. {items.X})</code> or <code>In "Item List" Product (E.g. {items.X.product})</code> this destination will look for the input event property starting from the <a href="https://community.commandersact.com/platform-x/developers/tracking/events-reference#item">items </a>or <a href="https://community.commandersact.com/platform-x/developers/tracking/events-reference#product">product </a>level respectively and add <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#pr_cd_">Product Custom Dimensions</a> and/or <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#pr_cm_">Product Custom Metrics</a> depending on your input <code>Event property name</code>.<br>If you select <code>In "Item Impression List" (E.g. {items_impression.X})</code>, you will add <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#il_pi_cd_">Product Impression Custom Dimensions</a> and/or <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#il_pi_cm_">Product Impression Custom Metrics</a> still depending on your input <code>Event property name</code>.</td></tr><tr><td><code>Client Id Cookie Name</code></td><td><p>Cookie name holding the Google Analytics "Client Id" that uniquely identifies a user instance of a web client. Default value: "<em>_ga</em>".</p><p><br>The "Client Id" is the right most string in the cookie, including a single dot. E.g. see the following blue highlighted string "GA1.1.<mark style="color:blue;">XXXXXXXXXX.XXXXXXXXXX</mark><strong>".</strong> </p></td></tr></tbody></table>

{% hint style="info" %}
**\[1]** Using "dots" (".") you can navigate deeper to the specific field you want to get the value of. See [Events reference](https://community.commandersact.com/platform-x/developers/tracking/events-reference) for more details on the standard field names by event. You can also freely set custom fields: there are no boundaries.
{% endhint %}

## Quick reference

{% hint style="info" %}
As recommended by Google, [Enhanced Ecommerce](https://developers.google.com/analytics/devguides/collection/protocol/v1/devguide#enhancedecom) hits are used in place of [Ecommerce ](https://developers.google.com/analytics/devguides/collection/protocol/v1/devguide#ecom)hits. See more details on UA "Hit Types" following this [LINK](https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#t).
{% endhint %}

| Commanders Act Events                                                                                                                                                                                                                                                                                                                                                                                                                          | UA Hit Types                                                                                         |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| <p><code>add_payment_info</code></p><p><code>add_shipping_info</code></p><p><code>begin_checkout</code></p><p><code>page_view</code></p><p><code>purchase</code></p>                                                                                                                                                                                                                                                                           | <p><code>pageview</code> <strong>[1]</strong></p><p><code>screenview</code> <strong>[1]</strong></p> |
| <p><code>add_to_cart</code></p><p><code>add_to_wishlist</code></p><p><code>generate_lead</code></p><p><code>login</code></p><p><code>refund</code></p><p><code>remove_from_cart</code></p><p><code>search</code></p><p><code>select_content</code></p><p><code>select_item</code></p><p><code>sign_up</code></p><p><code>view_cart</code></p><p><code>view_item</code></p><p><code>view_item_list</code></p><p><code>[Custom Event]</code></p> | `event`                                                                                              |
| `[Custom Event]`                                                                                                                                                                                                                                                                                                                                                                                                                               | `social` **\[2]**                                                                                    |

{% hint style="info" %}
**\[1]** This is either<mark style="color:blue;">`pageview`</mark>or<mark style="color:blue;">`screenview`</mark>, depending if the "Smart Mapping" field <mark style="color:blue;">`App Name (an)`</mark>is set with an empty value or a non-empty one.\
**\[2]** You can specify a custom social event by setting the "Smart Mapping" field <mark style="color:blue;">`Social Event`</mark>.
{% endhint %}

## Field mappings

{% hint style="info" %}
Most properties can be remapped using our "Smart Mapping" feature.
{% endhint %}

<table><thead><tr><th width="396.6685580062746">Commanders Act Properties</th><th>UA Properties</th></tr></thead><tbody><tr><td><code>Tracking ID</code></td><td><code>tid</code></td></tr><tr><td><p><code>partners.ga.client_id</code></p><p><code>Client Id Cookie Name</code></p><p><code>user.tcId</code></p></td><td><code>cid</code> <strong>[1]</strong></td></tr><tr><td><code>user.id</code></td><td><code>uid</code></td></tr><tr><td><code>context.device.ip</code></td><td><code>uip</code> <strong>[2]</strong></td></tr><tr><td><code>partners.ga.ad_id</code></td><td><code>gclid</code></td></tr><tr><td><code>context.page.url</code></td><td><code>dl</code></td></tr><tr><td><code>context.page.title</code></td><td><code>dt</code></td></tr><tr><td><code>context.page.referrer</code></td><td><code>dr</code></td></tr><tr><td><code>context.page.url</code></td><td><code>dh</code> <strong>[3]</strong></td></tr><tr><td><code>context.page.url</code></td><td><code>dp</code> <strong>[3]</strong></td></tr><tr><td><code>id</code></td><td><code>ti</code></td></tr><tr><td><code>value</code></td><td><code>tr</code></td></tr><tr><td><code>shipping_amount</code></td><td><code>ts</code></td></tr><tr><td><code>tax_amount</code></td><td><code>tt</code></td></tr><tr><td><code>coupon</code></td><td><code>tcc</code></td></tr><tr><td><code>partners.ga.affiliation</code></td><td><code>ta</code></td></tr><tr><td><code>currency</code></td><td><code>cu</code></td></tr><tr><td><code>partners.ga.product_action</code><br><code>[Default Value]</code></td><td><code>pa</code> <strong>[4]</strong></td></tr><tr><td><code>partners.ga.event_category</code></td><td><code>ec</code> <strong>[5]</strong></td></tr><tr><td><p><code>partners.ga.event_action</code></p><p><code>event_name</code></p></td><td><code>ea</code> <strong>[6]</strong></td></tr><tr><td><p><code>partners.ga.event_label</code></p><p><code>search_term</code></p><p><code>item_id</code></p><p><code>method</code></p></td><td><code>el</code> <strong>[7]</strong></td></tr><tr><td><code>items.X.id</code></td><td><code>pr(X+1)id</code></td></tr><tr><td><code>items.X.product.name</code></td><td><code>pr(X+1)nm</code></td></tr><tr><td><code>items.X.product.category_1</code></td><td><code>pr(X+1)ca</code></td></tr><tr><td><code>items.X.product.brand</code></td><td><code>pr(X+1)br</code></td></tr><tr><td><code>items.X.variant</code></td><td><code>pr(X+1)va</code></td></tr><tr><td><code>items.X.list_position</code></td><td><code>pr(X+1)ps</code></td></tr><tr><td><code>items.X.product.price</code></td><td><code>pr(X+1)pr</code></td></tr><tr><td><code>items.X.quantity</code></td><td><code>pr(X+1)qt</code></td></tr><tr><td><code>items.X.coupon</code></td><td><code>pr(X+1)cc</code></td></tr><tr><td><code>items_impression.X.0.list_name</code></td><td><code>il(X+1)nm</code></td></tr><tr><td><code>items_impression.X.Y.id</code></td><td><code>il(X+1)pi(Y+1)id</code></td></tr><tr><td><code>items_impression.X.Y.name</code></td><td><code>il(X+1)pi(Y+1)nm</code></td></tr><tr><td><code>items_impression.X.Y.brand</code></td><td><code>il(X+1)pi(Y+1)br</code></td></tr><tr><td><code>items_impression.X.Y.category_1</code></td><td><code>il(X+1)pi(Y+1)ca</code></td></tr><tr><td><code>items_impression.X.Y.variant</code></td><td><code>il(X+1)pi(Y+1)va</code></td></tr><tr><td><code>items_impression.X.Y.list_position</code></td><td><code>il(X+1)pi(Y+1)ps</code></td></tr><tr><td><code>items_impression.X.Y.price</code></td><td><code>il(X+1)pi(Y+1)pr</code></td></tr><tr><td><code>items_promotion.X.id</code></td><td><code>promo(X+1)id</code></td></tr><tr><td><code>items_promotion.X.name</code></td><td><code>promo(X+1)nm</code></td></tr><tr><td><code>items_promotion.X.creative</code></td><td><code>promo(X+1)cr</code></td></tr><tr><td><code>items_promotion.X.position</code></td><td><code>promo(X+1)ps</code></td></tr><tr><td><code>items_promotion.X.action</code></td><td><code>promoa</code></td></tr><tr><td><code>partners.ga.campaign_name</code></td><td><code>cn</code></td></tr><tr><td><code>partners.ga.campaign_source</code></td><td><code>cs</code></td></tr><tr><td><code>partners.ga.campaign_medium</code></td><td><code>cm</code></td></tr><tr><td><code>partners.ga.campaign_keyword</code></td><td><code>ck</code></td></tr><tr><td><code>partners.ga.campaign_content</code></td><td><code>cc</code></td></tr><tr><td><code>partners.ga.campaign_id</code></td><td><code>ci</code></td></tr><tr><td><code>partners.ga.queue_time</code></td><td><code>qt</code></td></tr><tr><td><code>context.app.name</code></td><td><code>an</code></td></tr><tr><td><code>context.app.namespace</code></td><td><code>aid</code></td></tr><tr><td><code>context.app.namespace</code></td><td><code>aiid</code></td></tr><tr><td><code>context.app.version</code></td><td><code>av</code></td></tr><tr><td><code>context.page.title</code></td><td><code>cd</code></td></tr><tr><td><code>(partners.ga.event_npa)</code></td><td><code>npa</code> <strong>[8]</strong></td></tr><tr><td><code>(partners.ga.non_iteration)</code></td><td><code>ni</code> <strong>[9]</strong></td></tr><tr><td><code>partners.ga.checkout_step</code></td><td><code>cos</code></td></tr><tr><td><code>partners.ga.checkout_step_option</code></td><td><code>col</code></td></tr><tr><td><code>partners.ga.social_name</code></td><td><code>sn</code></td></tr><tr><td><code>partners.ga.social_action</code></td><td><code>sa</code></td></tr><tr><td><code>partners.ga.social_action_target</code></td><td><code>st</code></td></tr><tr><td><code>Custom Event Properties</code></td><td><code>[Custom Property Name]</code> <strong>[10]</strong></td></tr></tbody></table>

{% hint style="info" %}
**\[1]**<mark style="color:blue;">`partners.ga.client_id`</mark>has priority over<mark style="color:blue;">`Client Id Cookie Name`</mark>and<mark style="color:blue;">`user.tcId`</mark>.\
**\[2]** Always anonymized just as though<mark style="color:blue;">`aip`</mark>([anonymize IP](https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters#aip)) is used.\
**\[3]** Retrieved by parsing the provided "Smart Mapping" field<mark style="color:blue;">`Document Location (dl)`</mark>.\
**\[4]** If<mark style="color:blue;">`items`</mark>is not set, then this property won't be present. \
If<mark style="color:blue;">`partners.ga.product_action`</mark>is not set, depending on the incoming event, the following values are used as default:<mark style="color:blue;">`detail`</mark>([page\_view](https://community.commandersact.com/platform-x/developers/tracking/events-reference#page\_view) event or if your event is not one of the following being listed),<mark style="color:blue;">`purchase`</mark>([purchase](https://community.commandersact.com/platform-x/developers/tracking/events-reference#purchase) event),<mark style="color:blue;">`click`</mark>([search](https://community.commandersact.com/platform-x/developers/tracking/events-reference#search), [add\_to\_wishlist](https://community.commandersact.com/platform-x/developers/tracking/events-reference#add\_to\_wishlist), [login](https://community.commandersact.com/platform-x/developers/tracking/events-reference#login), [select\_content](https://community.commandersact.com/platform-x/developers/tracking/events-reference#select\_content), [select\_item](https://community.commandersact.com/platform-x/developers/tracking/events-reference#select\_item), [sign\_up](https://community.commandersact.com/platform-x/developers/tracking/events-reference#sign\_up), [view\_cart](https://community.commandersact.com/platform-x/developers/tracking/events-reference#view\_cart), [view\_item](https://community.commandersact.com/platform-x/developers/tracking/events-reference#view\_item) and [view\_item\_list](https://community.commandersact.com/platform-x/developers/tracking/events-reference#view\_item\_list) events),<mark style="color:blue;">`refund`</mark>([refund](https://community.commandersact.com/platform-x/developers/tracking/events-reference#refund) event),<mark style="color:blue;">`checkout`</mark>([begin\_checkout](https://community.commandersact.com/platform-x/developers/tracking/events-reference#begin\_checkout), [add\_shipping\_info](https://community.commandersact.com/platform-x/developers/tracking/events-reference#add\_shipping\_info) and [add\_payment\_info](https://community.commandersact.com/platform-x/developers/tracking/events-reference#add\_payment\_info) events),<mark style="color:blue;">`add`</mark>([add\_to\_cart](https://community.commandersact.com/platform-x/developers/tracking/events-reference#add\_to\_cart) event), <mark style="color:blue;">`remove`</mark>([remove\_from\_cart ](https://community.commandersact.com/platform-x/developers/tracking/events-reference#remove\_from\_cart)event). \
**\[5]** If<mark style="color:blue;">`partners.ga.event_category`</mark>is not set, since this property is required for "event" hit types, this gets the default value:<mark style="color:blue;">`UX`</mark>.\
**\[6]** If<mark style="color:blue;">`partners.ga.event_action`</mark>is not set, then your event name is used.\
**\[7]** If<mark style="color:blue;">`partners.ga.event_label`</mark>is not set, depending on the incoming event, the following fields are used as default:<mark style="color:blue;">`search_term`</mark>([search](https://community.commandersact.com/platform-x/developers/tracking/events-reference#search) event),<mark style="color:blue;">`item_id`</mark> ([select\_content](https://community.commandersact.com/platform-x/developers/tracking/events-reference#select\_content) event) and<mark style="color:blue;">`method`</mark>([sign\_up](https://community.commandersact.com/platform-x/developers/tracking/events-reference#sign\_up) and [login](https://community.commandersact.com/platform-x/developers/tracking/events-reference#login) events).\
**\[8]** If<mark style="color:blue;">`partners.ga.event_npa`</mark>is set with one of the following values:<mark style="color:blue;">`1`</mark>(string or integer) or<mark style="color:blue;">`true`</mark>(boolean), then<mark style="color:blue;">`npa`</mark>is set with<mark style="color:blue;">`1`</mark>.\
**\[9]** If<mark style="color:blue;">`partners.ga.non_iteration`</mark>is set with one of the following values:<mark style="color:blue;">`1`</mark>(string or integer) or<mark style="color:blue;">`true`</mark>(boolean), then<mark style="color:blue;">`npa`</mark>is set with<mark style="color:blue;">`1`</mark>.\
**\[10]** See<mark style="color:blue;">`Custom Event Properties`</mark>in [Configuration](google-universal-analytics.md#configuration) for more details on how you can bridge custom properties to UA.
{% endhint %}
