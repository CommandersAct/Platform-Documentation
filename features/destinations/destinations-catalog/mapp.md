# Mapp

[Mapp](https://mapp.com/), formerly Webtrekk, generates actionable insights for brands to engage with their customers and deliver cross-channel marketing campaigns.\
Using this destination you can implement Mapp [server-side tracking](https://documentation.mapp.com/1.0/en/server-to-server-7240721.html).&#x20;

## Key features

The Mapp destination provides the following key features:

* **Events structure**: our [Events reference](https://community.commandersact.com/platform-x/developers/tracking/events-reference) covers [Mapp request types](https://documentation.mapp.com/1.0/en/which-request-types-are-supported-by-mapp-intelligence-36143348.html), meaning that your data is properly bridged to the expected fields in an optimized way.
* **Prebuilt mappings**: data mapping for event-based destinations happens automatically, which simplifies user inputs.
* **Custom events and properties**: you can freely push custom events and properties based on your specific needs.
* **Support for multi-item data**: information included in the [item](https://community.commandersact.com/platform-x/developers/tracking/events-reference#item) array is dispatched to Mapp.

## Destination setup

### Configuration

| Settings                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Track Domain`            | <p><em><strong><code>Required</code></strong></em></p><p>Your track domain as provided by Mapp.</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| `Track Id`                | <p><em><strong><code>Required</code></strong></em></p><p>Your track identifier as provided by Mapp.</p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| `Custom Event Properties` | <p>Map your custom event properties by setting their field names in <code>Event property name</code> and adding the field name holding the value <strong></strong> in <code>Commanders Act event property or static value</code>. E.g. if you input<code>size</code>in the <code>Event property name</code> and <code>properties.items.0.product.size</code> in <code>Commanders Act event property or static value</code>, you'll have a custom event property in Piano Analytics called<code>size</code>with a value based on the content of the field <code>properties.items.0.product.size</code> <strong>[1]</strong>. You also have the option to set a static string/numeric value in <code>Commanders Act event property or static value</code>.</p><p><br>In the column <code>Commanders Act event property position</code> you should keep the default value <code>Default {properties}</code> as it better fits most  scenarios. In case you select either <code>In "items" {properties.items.X}</code> or <code>In "product" {properties.items.X.product}</code> this destination will look for the input event property starting from the <a href="https://community.commandersact.com/platform-x/developers/tracking/events-reference#item">items </a>or <a href="https://community.commandersact.com/platform-x/developers/tracking/events-reference#product">product </a>level respectively and concatenate values separated by a semicolon (";").</p> |

{% hint style="info" %}
**\[1]** Using "dots" (".") you can navigate deeper to the specific field you want to get the value of. See [Events reference](https://community.commandersact.com/platform-x/developers/tracking/events-reference) for more details on the standard field names by event. You can also freely set custom fields: there are no boundaries.
{% endhint %}

## Quick reference

| Commanders Act Events | Mapp Request Type                         |
| --------------------- | ----------------------------------------- |
| `[All events]`        | `page`or`event`or`media`or`form` **\[1]** |

{% hint style="info" %}
**\[1]**<mark style="color:blue;">`partners.mapp.request_type`</mark>must be filled with: <mark style="color:blue;">`page`</mark>or<mark style="color:blue;">`event`</mark>or<mark style="color:blue;">`media`</mark>or<mark style="color:blue;">`form`</mark>depending on your specific mapping needs. Custom Commanders Act events are also supported. More details on Mapp request types are available following this [LINK](https://documentation.mapp.com/1.0/en/which-request-types-are-supported-by-mapp-intelligence-36143348.html).
{% endhint %}

## Field mappings

{% hint style="info" %}
Mapp client-side pixel saves a unique identifier in the [**wt3\_eid**](https://documentation.mapp.com/1.0/en/session-and-visitor-handling-7240758.html)****[ **** ](https://ads.tiktok.com/gateway/docs/index?identify\_key=2b9b4278e47b275f36e7c39a4af4ba067d088e031d5f5fe45d381559ac89ba48\&language=ENGLISH\&doc\_id=1727541103358977#item-link-Context%20object%20parameters)cookie. This destination sets the field<mark style="color:blue;">`eid`</mark>using the value provided in the cookie.

Depending on Mapp request types you're sending, some properties may not be tracked by Mapp. More details are available following this [LINK](https://documentation.mapp.com/1.0/en/which-request-types-are-supported-by-mapp-intelligence-36143348.html).
{% endhint %}

| Commanders Act Properties                                                                                                                                                               | Mapp Properties                   |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------- |
| `partners.mapp.version`,`page.title`,0,`device.screen.width`x`device.screen.height`,`device.density`,0,`event_timestamp`,`page.referrer`,`device.screen.width`x`device.screen.height`,0 | `p` **\[1]**                      |
| <p><code>partners.mapp.ceid</code> or</p><p><code>device.advertising_id</code></p>                                                                                                      | `ceid` **\[2]**                   |
| `device.ip`                                                                                                                                                                             | `X-WT-IP`                         |
| `device.user_agent`                                                                                                                                                                     | `X-WT-UA`                         |
| `page.location`                                                                                                                                                                         | `X-WT-RQ`                         |
| `page.lang`                                                                                                                                                                             | `la`                              |
| <p><code>partners.mapp.event_name</code> or</p><p><code>event_name</code></p>                                                                                                           | `ct` **\[3]**                     |
| `properties.currency`                                                                                                                                                                   | `cr`                              |
| `properties.id`                                                                                                                                                                         | `oi`                              |
| `properties.value`                                                                                                                                                                      | `ov`                              |
| `(event_name)`                                                                                                                                                                          | `st` **\[4]**                     |
| `properties.items.X.product.name`                                                                                                                                                       | `ba` **\[5]**                     |
| `properties.items.X.product.price`\*`properties.items.X.quantity`                                                                                                                       | `co` **\[5]**                     |
| `properties.items.X.quantity`                                                                                                                                                           | `qn` **\[5]**                     |
| `properties.items.X.list_position`                                                                                                                                                      | `plp` **\[5]**                    |
| `Custom Event Properties`                                                                                                                                                               | `[Custom Property Name]` **\[6]** |

{% hint style="info" %}
**\[1]** Default value: <mark style="color:blue;">`300,0,0,0,0,0,event_timestamp,0,0,0`</mark>.\ <mark style="color:blue;">``</mark>**\[2]**<mark style="color:blue;">`partners.mapp.ceid`</mark>has priority over<mark style="color:blue;">`device.advertising_id`</mark>.\
**\[3]**<mark style="color:blue;">`partners.mapp.event_name`</mark>has priority over<mark style="color:blue;">`event_name`</mark>.\
**\[4]** If the [**items**](https://community.commandersact.com/platform-x/developers/tracking/events-reference#item) array is filled and depending on incoming events, this is set with:\
&#x20;     •<mark style="color:blue;">**`add`**</mark>, when<mark style="color:blue;">`event_name`</mark>is<mark style="color:blue;">`add_to_cart`</mark>.\
&#x20;     •<mark style="color:blue;">**`conf`**</mark>, when<mark style="color:blue;">`event_name`</mark>is<mark style="color:blue;">`purchase`</mark>.\
&#x20;     •<mark style="color:blue;">**`view`**</mark>, as default value.\
**\[5]** Product information separated by semicolon and computed amounts are rounded with two decimals.\
**\[6]** See<mark style="color:blue;">`Custom Event Properties`</mark>in [Configuration ](mapp.md#configuration)for more details on how you can bridge custom properties to Mapp.
{% endhint %}
